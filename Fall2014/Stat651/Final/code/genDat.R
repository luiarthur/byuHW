source("rfunctions.R")
H. <- matrix(c(0,0,0,0,0,0,
              0,1,0,0,1,0,
              0,1,0,0,1,0,
              0,1,1,1,1,0,
              0,1,0,0,1,0,
              0,1,0,0,1,0),6,6,byrow=T)

E. <- matrix(c(0,0,0,0,0,0,
              0,1,1,1,1,0,
              0,1,0,0,0,0,
              0,1,1,1,1,0,
              0,1,0,0,0,0,
              0,1,1,1,1,0),6,6,byrow=T)

A. <- matrix(c(0,0,0,0,0,0,
              0,1,1,1,1,0,
              0,1,0,0,1,0,
              0,1,1,1,1,0,
              0,1,0,0,1,0,
              0,1,0,0,1,0),6,6,byrow=T)

R. <- matrix(c(1,1,1,0,0,0,
              1,0,0,1,0,0,
              1,0,0,1,0,0,
              1,1,1,0,0,0,
              1,0,0,1,0,0,
              1,0,0,1,0,0),6,6,byrow=T)

T. <- matrix(c(0,0,0,0,0,0,
              1,1,1,1,1,0,
              0,0,1,0,0,0,
              0,0,1,0,0,0,
              0,0,1,0,0,0,
              0,0,1,0,0,0),6,6,byrow=T)

S. <- matrix(c(0,0,0,0,0,0,
              0,0,1,1,1,0,
              0,0,1,0,0,0,
              0,0,1,1,1,0,
              0,0,0,0,1,0,
              0,0,1,1,1,0),6,6,byrow=T)

Z <- matrix(sample(0:1,150*6,replace=TRUE),150,6)
for (i in 1:150) {
  while(sum(Z[i,])==0) Z[i,] <- sample(0:1,6,replace=TRUE)
}

#apply(Z,1,sum)

A <- rbind(c(H.),c(E.),c(A.),c(R.),c(T.),c(S.))
E <- matrix(rnorm(150*36,0,.5),150,36)
Y <- Z%*%A+E

#a.image(X)
